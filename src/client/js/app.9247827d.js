(function(t){function e(e){for(var o,s,r=e[0],c=e[1],u=e[2],l=0,f=[];l<r.length;l++)s=r[l],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&f.push(n[s][0]),n[s]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);d&&d(e);while(f.length)f.shift()();return a.push.apply(a,u||[]),i()}function i(){for(var t,e=0;e<a.length;e++){for(var i=a[e],o=!0,r=1;r<i.length;r++){var c=i[r];0!==n[c]&&(o=!1)}o&&(a.splice(e--,1),t=s(s.s=i[0]))}return t}var o={},n={app:0},a=[];function s(e){if(o[e])return o[e].exports;var i=o[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=t,s.c=o,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(i,o,function(e){return t[e]}.bind(null,o));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var u=0;u<r.length;u++)e(r[u]);var d=c;a.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"034f":function(t,e,i){"use strict";i("85ec")},"04b7":function(t,e,i){},"26cf":function(t,e,i){},"375d":function(t,e,i){"use strict";i("04b7")},"396b":function(t,e,i){"use strict";i("c623")},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var o=i("2b0e"),n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("div",{staticClass:"app-container"},[i("router-view")],1)])},a=[],s=(i("034f"),i("2877")),r={},c=Object(s["a"])(r,n,a,!1,null,null,null),u=c.exports,d=i("8c4f"),l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"positions"},[i("h1",{staticClass:"app-container__heading"},[t._v("Позиции меню")]),i("b-button-toolbar",{staticClass:"toolbar"},[i("div",{staticClass:"toolbar__filters"},[i("h3",[t._v("Фильтры")]),t.filters.length>0?i("b-button",{attrs:{variant:"danger"},on:{click:t.clearFilters}},[t._v("Сбросить")]):t._e()],1),i("b-button-group",{staticClass:"toolbar__buttons"},[i("b-button",{attrs:{variant:"success"},on:{click:function(e){return t.$router.push("/position/new")}}},[t._v("Добавить позицию")]),i("b-button",{attrs:{variant:"outline-primary"},on:{click:function(e){return t.$router.push("/categories")}}},[t._v("Редактировать категории")])],1)],1),i("div",{staticClass:"filters"},[i("categories-list",{attrs:{selectedTags:t.filters},on:{selectTag:function(e){return t.onSelectTag(e)},removeTag:function(e){return t.onRemoveTag(e)}}})],1),i("b-container",{staticClass:"positions-container"},t._l(t.filteredPositions,(function(t){return i("menu-positions-item",{key:t.id,attrs:{data:t}})})),1)],1)},f=[],m=(i("c740"),i("a434"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-row",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"item",attrs:{title:"Нажмите, чтобы просмотреть подробности"},on:{click:function(e){return t.$router.push({name:"Position",params:{id:t.data.id}})}}},[i("b-col",{staticClass:"item__name"},[t._v(t._s(t.data.name))]),i("b-col",{staticClass:"item__price",attrs:{lg:"2"}},[t._v(t._s(t.data.price_rub)+" руб")])],1)}),p=[],g={name:"MenuPositionsItem",props:{data:Object}},h=g,v=(i("b026"),Object(s["a"])(h,m,p,!1,null,"1d4efb19",null)),b=v.exports,_=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"categories-list"},t._l(t.categories,(function(e){return i("category-item",{key:e.id,staticClass:"categories-list__item",attrs:{id:e.id,name:e.name,description:e.description,tags:e.tags,selected:e.selected},on:{selectTag:function(i){return t.onSelectTag(i,e)},removeTag:function(i){return t.onRemoveTag(e.id)},updateCategory:t.onUpdateCategory}})})),1)},y=[],w=(i("7db0"),i("d3b7"),i("d81d"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"category"},[i("b-dropdown",{attrs:{text:t.dropdownText,variant:t.variant}},[t._l(t.tags,(function(e){return i("b-dropdown-item",{key:e.id,attrs:{title:e.value},on:{click:function(i){return t.selectTag(e)}}},[t._v(" "+t._s(e.value)+" ")])})),"edit"===t.mode?i("b-dropdown-item",{staticClass:"category__action",attrs:{title:"Редактировать"},on:{click:t.editCategory}},[t._v(" Редактировать ")]):t._e(),"edit"===t.mode?i("b-dropdown-item",{staticClass:"category__action",attrs:{title:"Удалить"},on:{click:t.deleteCategory}},[t._v(" Удалить ")]):t._e(),"choose"===t.mode?i("b-dropdown-item",{staticClass:"category__action",attrs:{title:"Убрать тег"},on:{click:t.removeTag}},[t._v(" Убрать тег ")]):t._e()],2),i("b-modal",{attrs:{title:"Редактирование категории"},scopedSlots:t._u([{key:"modal-footer",fn:function(e){var o=e.cancel;return[i("b-button",{attrs:{variant:"danger"},on:{click:o}},[t._v(" Отмена ")]),i("b-button",{attrs:{variant:"success"},on:{click:t.saveEdit}},[t._v(" Сохранить ")])]}}]),model:{value:t.modalEditShown,callback:function(e){t.modalEditShown=e},expression:"modalEditShown"}},[i("b-form",[i("b-form-group",{attrs:{label:"Наименование*","label-for":"input-name"}},[i("b-form-input",{attrs:{id:"input-name",required:""},model:{value:t.editData.name,callback:function(e){t.$set(t.editData,"name",e)},expression:"editData.name"}})],1),i("b-form-group",{attrs:{label:"Описание","label-for":"input-description"}},[i("b-form-input",{attrs:{id:"input-description"},model:{value:t.editData.description,callback:function(e){t.$set(t.editData,"description",e)},expression:"editData.description"}})],1),i("b-form-tags",{attrs:{placeholder:"Введите значения категории через запятую",separator:","},model:{value:t.tagValues,callback:function(e){t.tagValues=e},expression:"tagValues"}})],1)],1)],1)}),C=[],k=i("b85c"),D=(i("a9e3"),i("b0c0"),i("a4d3"),i("e01a"),{name:"CategoryItem",props:{id:{type:Number,required:!0},name:{type:String,required:!0},description:{type:String,required:!1},tags:{type:Array,required:!0},selected:{type:Number,default:null}},inject:["mode"],data:function(){return{modalEditShown:!1,editData:{name:null,description:null,tags:{new:[],deleted:[]}},tagValues:[],tagsData:{},deleteConfirm:""}},computed:{dropdownText:function(){var t=this;if(this.selected){var e=this.tags.find((function(e){return e.id===t.selected}));return e.value}return this.name},variant:function(){return this.selected?"info":"secondary"}},methods:{selectTag:function(t){"choose"===this.mode&&this.$emit("selectTag",{id:t.id})},removeTag:function(){this.$emit("removeTag")},deleteCategory:function(){var t=this;this.$bvModal.msgBoxConfirm("Удалить категорию?",{title:"Удаление",size:"sm",buttonSize:"sm",okVariant:"danger",okTitle:"Да",cancelTitle:"Нет",hideHeaderClose:!1,centered:!0}).then((function(e){e&&t.$store.dispatch("deleteCategory",t.id).then((function(e){200===e.status&&t.showModalOk("Категория со всеми ее тегами удалена")})).catch((function(t){console.log(t)}))})).catch((function(t){console.log(t)}))},showModalOk:function(t){this.$bvModal.msgBoxOk(t).then((function(t){return t})).catch((function(t){console.log(t)}))},editCategory:function(){this.editData.name=this.name,this.editData.description=this.description;var t,e=Object(k["a"])(this.tags);try{for(e.s();!(t=e.n()).done;){var i=t.value;this.tagsData[i.value]=i.id,this.tagValues.push(i.value)}}catch(o){e.e(o)}finally{e.f()}this.modalEditShown=!0},saveEdit:function(){var t=this,e={id:this.id};this.editData.name!==this.name&&(e.name=this.editData.name),this.editData.description!==this.description&&(e.description=this.editData.description);var i,o=Object(k["a"])(this.tagValues);try{for(o.s();!(i=o.n()).done;){var n=i.value;this.tagsData[n]?delete this.tagsData[n]:this.editData.tags.new.push({value:n})}}catch(s){o.e(s)}finally{o.f()}for(var a in this.tagsData)this.editData.tags.deleted.push({id:this.tagsData[a]});e.tags=this.editData.tags,this.$store.dispatch("putCategory",e).then((function(e){200===e.status&&(t.$emit("updateCategory"),t.showModalOk("Категория успешно обновлена"),t.modalEditShown=!1)})).catch((function(t){console.log(t)}))}}}),P=D,x=(i("396b"),Object(s["a"])(P,w,C,!1,null,"83d2006e",null)),T=x.exports,$={name:"CategoriesList",components:{CategoryItem:T},props:{selectedTags:{type:Array,default:function(){return[]}}},data:function(){return{categories:[]}},methods:{onSelectTag:function(t,e){var i=e.tags.find((function(e){return e.id===t.id}));this.$emit("selectTag",{tag:i})},onRemoveTag:function(t){this.$emit("removeTag",{categoryId:t})},onUpdateCategory:function(){this.updateCategories()},updateCategories:function(){var t=this;this.categories=this.$store.state.categories.map((function(e){var i=t.selectedTags.find((function(t){return t.categoryId===e.id}));return e.selected=null===i||void 0===i?void 0:i.id,e}))}},beforeMount:function(){var t=this;0===this.$store.state.categories.length?this.$store.dispatch("getCategories").then((function(e){200===e.status&&t.updateCategories()})):this.updateCategories()},watch:{selectedTags:function(){this.updateCategories()},"$store.state.categories":function(){this.updateCategories()}}},O=$,S=(i("b9a0"),Object(s["a"])(O,_,y,!1,null,"1b88cd2e",null)),I=S.exports,E={name:"MenuPositions",components:{MenuPositionsItem:b,CategoriesList:I},provide:function(){return{mode:"choose"}},data:function(){return{filters:[]}},computed:{filteredPositions:function(){return this.filters.length>0?this.$store.getters.filteredPositions(this.filters):this.$store.state.positions}},methods:{onSelectTag:function(t){var e=this.filters.findIndex((function(e){return e.categoryId===t.tag.categoryId}));e>=0?this.filters.splice(e,1,t.tag):this.filters.push(t.tag)},onRemoveTag:function(t){var e=this.filters.findIndex((function(e){return e.categoryId===t.categoryId}));this.filters.splice(e,1)},clearFilters:function(){this.filters=[]}},created:function(){0===this.$store.state.positions.length&&this.$store.dispatch("getPositions")}},j=E,N=(i("a70b"),Object(s["a"])(j,l,f,!1,null,"5974cd93",null)),M=N.exports,F=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"position"},[i("div",{staticClass:"position__top"},[i("router-link",{attrs:{to:"/"}},[t._v("К списку позиций")]),i("b-button",{attrs:{variant:"danger"},on:{click:t.deletePosition}},[t._v("Удалить")])],1),"edit name"!==t.mode?i("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"group",attrs:{title:"Нажмите, чтобы изменить"},on:{click:function(e){t.mode="edit name"}}},[i("h1",{staticClass:"position__header"},[t._v(t._s(t.name))])]):"edit name"===t.mode?i("div",{staticClass:"group-edit"},[i("b-form-input",{attrs:{autofocus:"",placeholder:"Введите наименование позиции"},on:{blur:function(e){t.mode="show"},keydown:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.mode="show"}},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1):t._e(),"edit description"!==t.mode?i("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"group",attrs:{title:"Нажмите, чтобы изменить"},on:{click:function(e){t.mode="edit description"}}},[i("h4",[t._v("Описание")]),i("p",[t._v(t._s(t.description?t.description:"отсутствует"))])]):"edit description"===t.mode?i("div",{staticClass:"group-edit"},[i("b-form-textarea",{attrs:{rows:"3",autofocus:"",placeholder:"Введите описание"},on:{blur:function(e){t.mode="show"},keydown:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.mode="show"}},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}})],1):t._e(),"edit ingredients"!==t.mode?i("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"group",attrs:{title:"Нажмите, чтобы изменить"},on:{click:function(e){t.mode="edit ingredients"}}},[i("h4",[t._v("Состав")]),i("p",[t._v(t._s(t.ingredients?t.ingredients:"отсутствует"))])]):"edit ingredients"===t.mode?i("div",{staticClass:"group-edit"},[i("b-form-textarea",{attrs:{rows:"3",autofocus:"",placeholder:"Введите состав"},on:{blur:function(e){t.mode="show"},keydown:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.mode="show"}},model:{value:t.ingredients,callback:function(e){t.ingredients=e},expression:"ingredients"}})],1):t._e(),i("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],class:{group:"edit weight"!==t.mode,"group-edit":"edit weight"===t.mode},attrs:{title:"Нажмите, чтобы изменить"},on:{click:function(e){t.mode="edit weight"}}},[i("h4",[t._v("Вес нетто: "),"edit weight"!==t.mode?i("strong",[t._v(t._s(t.weight_g?t.weight_g:"-"))]):"edit weight"===t.mode?i("b-form-input",{staticClass:"group-edit__input-number",attrs:{type:"number",autofocus:""},on:{blur:function(e){t.mode="show"},keydown:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.mode="show"}},model:{value:t.weight_g,callback:function(e){t.weight_g=e},expression:"weight_g"}}):t._e(),t._v(" г ")],1)]),i("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],class:{group:"edit volume"!==t.mode,"group-edit":"edit volume"===t.mode},attrs:{title:"Нажмите, чтобы изменить"},on:{click:function(e){t.mode="edit volume"}}},[i("h4",[t._v("Объем: "),"edit volume"!==t.mode?i("strong",[t._v(t._s(t.volume_ml?t.volume_ml:"-"))]):"edit volume"===t.mode?i("b-form-input",{staticClass:"group-edit__input-number",attrs:{type:"number",autofocus:""},on:{blur:function(e){t.mode="show"},keydown:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.mode="show"}},model:{value:t.volume_ml,callback:function(e){t.volume_ml=e},expression:"volume_ml"}}):t._e(),t._v(" мл ")],1)]),i("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],class:{group:"edit price"!==t.mode,"group-edit":"edit price"===t.mode},attrs:{title:"Нажмите, чтобы изменить"},on:{click:function(e){t.mode="edit price"}}},[i("h3",[t._v("Цена: "),"edit price"!==t.mode?i("strong",[t._v(t._s(t.price_rub))]):"edit price"===t.mode?i("b-form-input",{staticClass:"group-edit__input-number",attrs:{type:"number",autofocus:""},on:{blur:function(e){t.mode="show"},keydown:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.mode="show"}},model:{value:t.price_rub,callback:function(e){t.price_rub=e},expression:"price_rub"}}):t._e(),t._v(" руб ")],1)]),i("div",{staticClass:"group"},[i("h3",[t._v("Категории")]),i("categories-list",{attrs:{selectedTags:t.tags},on:{selectTag:function(e){return t.onSelectTag(e)},removeTag:function(e){return t.onRemoveTag(e)}}})],1),i("b-modal",{attrs:{id:"modal-delete",title:"Позиция удалена","hide-footer":!0}},[i("p",[t._v("Возвращаемся к списку...")])])],1)},R=[],U={name:"Position",components:{CategoriesList:I},provide:function(){return{mode:"choose"}},data:function(){return{mode:"show",name:"Наименование позиции отсутствует",description:"отсутствует",ingredients:"отсутствует",weight_g:"-",volume_ml:"-",price_rub:"-",tags:[]}},props:["id"],beforeMount:function(){var t=this;this.$store.state.positions.length>0?(this.$store.commit({type:"setCurrentPosition",currentPosition:this.$store.state.positions.find((function(e){return e.id===+t.id}))}),this.getPositionData()):this.$store.dispatch("getPositionById",this.id).then((function(e){200===e.status&&t.getPositionData()}))},beforeDestroy:function(){this.$store.commit({type:"setCurrentPosition",currentPosition:null})},methods:{getPositionData:function(){var t=this.$store.state.currentPosition;this.name=t.name,this.description=t.description,this.ingredients=t.ingredients,this.weight_g=t.weight_g,this.volume_ml=t.volume_ml,this.price_rub=t.price_rub,this.tags=t.tags},deletePosition:function(){var t=this;this.$bvModal.msgBoxConfirm("Удалить позицию?",{title:"Удаление",size:"sm",buttonSize:"sm",okVariant:"danger",okTitle:"Да",cancelTitle:"Нет",hideHeaderClose:!1,centered:!0}).then((function(e){e&&t.$store.dispatch("deletePosition",t.id).then((function(e){200===e.status&&(t.$bvModal.show("modal-delete"),setTimeout((function(){t.$router.push("/")}),2e3))}))}))},onSelectTag:function(t){var e={added:{id:t.tag.id}},i=this.tags.find((function(e){return e.categoryId===t.tag.categoryId}));i&&(e.removed={id:i.id}),this.sendUpdate({id:this.id,tags:e})},onRemoveTag:function(t){var e=this.tags.find((function(e){return e.categoryId===t.categoryId})),i={removed:{id:e.id}};this.sendUpdate({id:this.id,tags:i})},sendUpdate:function(t){var e=this;this.$store.dispatch("putPosition",t).then((function(t){200===t.status&&e.getPositionData()}))}},watch:{mode:function(t,e){if("show"===t){var i={id:this.id,name:null,description:null,ingredients:null,weight_g:null,volume_ml:null,price_rub:null};switch(e){case"edit name":i.name=this.name;break;case"edit description":i.description=this.description;break;case"edit ingredients":i.ingredients=this.ingredients;break;case"edit weight":i.weight_g=this.weight_g;break;case"edit volume":i.volume_ml=this.volume_ml;break;case"edit price":i.price_rub=this.price_rub;break}this.sendUpdate(i)}}}},V=U,q=(i("375d"),Object(s["a"])(V,F,R,!1,null,"24722ab0",null)),L=q.exports,B=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"new-position"},[i("router-link",{staticClass:"back",attrs:{to:"/"}},[t._v("К списку позиций")]),i("h1",{staticClass:"app-container__heading"},[t._v("Новая позиция")]),i("b-form",{staticClass:"new-position__form",on:{submit:t.sendNewPosition,reset:t.resetForm}},[i("b-form-group",{attrs:{label:"Наименование*","label-for":"input-name"}},[i("b-form-input",{attrs:{id:"input-name",required:""},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),i("b-form-group",{attrs:{label:"Описание","label-for":"input-description"}},[i("b-form-textarea",{attrs:{rows:"3",id:"input-description"},model:{value:t.formData.description,callback:function(e){t.$set(t.formData,"description",e)},expression:"formData.description"}})],1),i("b-form-group",{attrs:{label:"Состав","label-for":"input-ingredients"}},[i("b-form-textarea",{attrs:{rows:"3",id:"input-ingredients"},model:{value:t.formData.ingredients,callback:function(e){t.$set(t.formData,"ingredients",e)},expression:"formData.ingredients"}})],1),i("b-form-group",{attrs:{label:"Масса нетто","label-for":"input-weight",description:"Единица измерения - г"}},[i("b-form-input",{attrs:{type:"number",id:"input-weight"},model:{value:t.formData.weight_g,callback:function(e){t.$set(t.formData,"weight_g",e)},expression:"formData.weight_g"}})],1),i("b-form-group",{attrs:{label:"Объем","label-for":"input-volume",description:"Единица измерения - мл"}},[i("b-form-input",{attrs:{type:"number",id:"input-volume"},model:{value:t.formData.volume_ml,callback:function(e){t.$set(t.formData,"volume_ml",e)},expression:"formData.volume_ml"}})],1),i("b-form-group",{attrs:{label:"Цена*","label-for":"input-price",description:"Единица измерения - руб"}},[i("b-form-input",{attrs:{type:"number",id:"input-price",required:""},model:{value:t.formData.price_rub,callback:function(e){t.$set(t.formData,"price_rub",e)},expression:"formData.price_rub"}})],1),i("b-form-group",{attrs:{label:"Категории","label-for":"input-tags"}},[i("categories-list",{attrs:{selectedTags:t.formData.tags},on:{selectTag:function(e){return t.onSelectTag(e)},removeTag:function(e){return t.onRemoveTag(e)}}}),t.formData.tags.length>0?i("b-button",{attrs:{variant:"danger"},on:{click:t.clearTags}},[t._v(" Очистить категории")]):t._e()],1),i("div",{staticClass:"success",class:{shown:t.dataSent}},[t._v("Позиция добавлена!")]),i("b-button",{staticClass:"form-button",attrs:{type:"submit",variant:"success"}},[t._v("Добавить позицию")]),i("b-button",{staticClass:"form-button",attrs:{type:"reset",variant:"danger"}},[t._v("Очистить форму")])],1)],1)},A=[],z={name:"NewPosition",components:{CategoriesList:I},provide:function(){return{mode:"choose"}},data:function(){return{formData:{name:"",description:"",ingredients:"",weight_g:"",volume_ml:"",price_rub:"",tags:[]},dataSent:!1}},methods:{onSelectTag:function(t){var e=this.formData.tags.findIndex((function(e){return e.categoryId===t.tag.categoryId}));e>=0?this.formData.tags.splice(e,1,t.tag):this.formData.tags.push(t.tag)},onRemoveTag:function(t){var e=this.formData.tags.findIndex((function(e){return e.categoryId===t.categoryId}));this.formData.tags.splice(e,1)},clearTags:function(){this.formData.tags=[]},resetForm:function(){this.formData.name="",this.formData.description="",this.formData.ingredients="",this.formData.weight_g="",this.formData.volume_ml="",this.formData.price_rub="",this.clearTags()},sendNewPosition:function(t){var e=this;t.preventDefault(),this.$store.dispatch("postNewPosition",{name:this.formData.name,description:this.formData.description,ingredients:this.formData.ingredients,weight_g:this.formData.weight_g,volume_ml:this.formData.volume_ml,price_rub:this.formData.price_rub,tags:this.formData.tags.map((function(t){return{id:t.id}}))}).then((function(t){200===t.status&&(e.dataSent=!0,setTimeout((function(){e.dataSent=!1}),2e3),e.resetForm())}))}}},H=z,J=(i("988f"),Object(s["a"])(H,B,A,!1,null,"1603e0b0",null)),G=J.exports,K=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"categories"},[i("router-link",{staticClass:"back",attrs:{to:"/"}},[t._v("Назад к списку позиций")]),i("h1",{staticClass:"app-container__heading"},[t._v("Категории")]),i("categories-list",{staticClass:"categories__list"}),i("div",{staticClass:"categories__new"},[i("b-button",{staticClass:"new-button",attrs:{variant:t.showForm?"danger":"success"},on:{click:function(e){t.showForm=!t.showForm}}},[t._v(t._s(t.showForm?"Закрыть форму":"Новая категория"))]),t.showForm?i("b-form",{staticClass:"new-form",on:{submit:function(e){return e.preventDefault(),t.sendNewCategory.apply(null,arguments)}}},[i("b-form-input",{attrs:{placeholder:"Название категории",required:""},model:{value:t.newCategory.name,callback:function(e){t.$set(t.newCategory,"name",e)},expression:"newCategory.name"}}),i("b-form-input",{attrs:{placeholder:"Описание категории"},model:{value:t.newCategory.description,callback:function(e){t.$set(t.newCategory,"description",e)},expression:"newCategory.description"}}),i("b-form-tags",{attrs:{placeholder:"Введите значения категории через запятую",separator:",","input-attrs":{"aria-describedby":"tags-validation-help"}},model:{value:t.newCategory.tags,callback:function(e){t.$set(t.newCategory,"tags",e)},expression:"newCategory.tags"}}),i("p",[t._v("Минимум 2 тега (значения)")]),i("b-button",{attrs:{variant:"success",type:"submit"}},[t._v("Создать")])],1):t._e()],1)],1)},Q=[],W={name:"Categories",components:{CategoriesList:I},provide:function(){return{mode:"edit"}},data:function(){return{showForm:!1,newCategory:{name:"",description:null,tags:[]}}},methods:{sendNewCategory:function(){var t=this;this.newCategory.tags.length>=2&&this.$store.dispatch("postNewCategory",{name:this.newCategory.name,description:this.newCategory.description,tags:this.newCategory.tags}).then((function(e){200===e.status&&(t.showModalOk(),t.clearForm())}))},clearForm:function(){this.newCategory.name="",this.newCategory.description="",this.newCategory.tags=[]},showModalOk:function(){this.$bvModal.msgBoxOk("Категория успешно сохранена").then((function(t){return t})).catch((function(t){console.log(t)}))}}},X=W,Y=(i("b1f2"),Object(s["a"])(X,K,Q,!1,null,"3dba7d9a",null)),Z=Y.exports;o["default"].use(d["a"]);var tt=[{path:"/",name:"MenuPositions",component:M},{path:"/position/new",name:"NewPosition",component:G},{path:"/position/:id",name:"Position",component:L,props:!0},{path:"/categories",name:"Categories",component:Z}],et=new d["a"]({mode:"history",base:"/",routes:tt}),it=et,ot=(i("4de4"),i("2f62")),nt=i("bc3a"),at=i.n(nt);o["default"].use(ot["a"]);var st=at.a.create({baseURL:Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_APIURL}),rt=new ot["a"].Store({state:{positions:[],categories:[],currentPosition:null},getters:{filteredPositions:function(t){return function(e){return t.positions.filter((function(t){var i,o=!0,n=Object(k["a"])(e);try{var a=function(){var e=i.value,n=t.tags.find((function(t){return t.id===e.id}));if(!n)return o=!1,"break"};for(n.s();!(i=n.n()).done;){var s=a();if("break"===s)break}}catch(r){n.e(r)}finally{n.f()}return o}))}}},mutations:{setPositions:function(t,e){t.positions=e.positions},setCurrentPosition:function(t,e){t.currentPosition=e.currentPosition},pushToPositions:function(t,e){t.positions.push(e.position)},updatePosition:function(t,e){if(t.currentPosition=e,t.positions.length>0){var i=t.positions.findIndex((function(t){return t.id===e.id}));t.positions[i]=e}},deletePosition:function(t,e){if(t.currentPosition=null,t.positions.length>0){var i=t.positions.findIndex((function(t){return t.id===e.id}));t.positions.splice(i,1)}},setCategories:function(t,e){t.categories=e.categories},pushToCategories:function(t,e){t.categories.push(e.category)},updateCategory:function(t,e){var i=t.categories.findIndex((function(t){return t.id===e.category.id}));t.categories[i]=e.category},deleteCategory:function(t,e){var i=t.categories.findIndex((function(t){return t.id===e.id}));t.categories.splice(i,1)}},actions:{getPositions:function(t){return st.get("positions").then((function(e){return 200===e.status&&t.commit({type:"setPositions",positions:e.data}),e}))},getPositionById:function(t,e){return st.get("positions/"+e).then((function(e){return 200===e.status&&t.commit({type:"setCurrentPosition",currentPosition:e.data}),e}))},postNewPosition:function(t,e){return st.post("position/new",e).then((function(e){return 200===e.status&&t.state.positions.length>0&&t.commit({type:"pushToPositions",position:e.data}),e}))},putPosition:function(t,e){return st.put("positions/"+e.id,e).then((function(e){return 200===e.status&&t.commit("updatePosition",e.data),e}))},deletePosition:function(t,e){return st.delete("positions/"+e).then((function(e){return 200===e.status&&t.commit("deletePosition",{id:e.data.id}),e}))},getCategories:function(t){return st.get("categories").then((function(e){return 200===e.status&&t.commit({type:"setCategories",categories:e.data}),e}))},postNewCategory:function(t,e){return st.post("category/new",e).then((function(e){return 200===e.status&&t.commit({type:"pushToCategories",category:e.data}),e}))},putCategory:function(t,e){return st.put("category/"+e.id,e).then((function(e){return 200===e.status&&t.commit({type:"updateCategory",category:e.data}),e}))},deleteCategory:function(t,e){return st.delete("category/"+e).then((function(i){200===i.status&&t.commit({type:"deleteCategory",id:e})}))}}}),ct=i("5f5b"),ut=i("b1e0");i("f9e3"),i("2dd8");o["default"].use(ct["a"]),o["default"].use(ut["a"]),o["default"].config.productionTip=!1,new o["default"]({router:it,store:rt,render:function(t){return t(u)}}).$mount("#app")},"6f9c":function(t,e,i){},"72dc":function(t,e,i){},"7abb":function(t,e,i){},"85ec":function(t,e,i){},"988f":function(t,e,i){"use strict";i("26cf")},a70b:function(t,e,i){"use strict";i("af7f")},af7f:function(t,e,i){},b026:function(t,e,i){"use strict";i("7abb")},b1f2:function(t,e,i){"use strict";i("6f9c")},b9a0:function(t,e,i){"use strict";i("72dc")},c623:function(t,e,i){}});
//# sourceMappingURL=app.9247827d.js.map